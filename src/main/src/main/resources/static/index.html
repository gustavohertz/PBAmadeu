<!doctype html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>Func. - Listagem</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
</head>
<body class="py-4">
<div class="container">
    <h1 class="mb-3">Funcionários</h1>
    <div class="mb-3">
        <a href="#/novo" class="btn btn-primary">Novo Funcionário</a>
    </div>
    <table id="tabela" class="table table-striped">
        <thead><tr><th>ID</th><th>Nome</th><th>CPF</th><th>Ações</th></tr></thead>
        <tbody id="lista"></tbody>
    </table>
</div>

<script>
    // Exemplo: troca simples entre rotas hash (index e form)
    function loadList() {
        const lista = document.getElementById('lista');
        lista.innerHTML = '';
        // exemplo estático: ideal conectar com sua API via fetch(...)
        const dados = JSON.parse(localStorage.getItem('funcs') || '[]');
        dados.forEach(f => {
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${f.id}</td><td>${f.nome}</td><td>${f.cpf}</td>
          <td>
            <a href="#/editar/${f.id}" class="btn btn-sm btn-outline-secondary">Editar</a>
            <button data-id="${f.id}" class="btn btn-sm btn-outline-danger btn-del">Excluir</button>
          </td>`;
            lista.appendChild(tr);
        });

        document.querySelectorAll('.btn-del').forEach(btn => {
            btn.addEventListener('click', e => {
                const id = e.target.getAttribute('data-id');
                if (confirm('Confirma exclusão?')) {
                    const novo = (JSON.parse(localStorage.getItem('funcs') || '[]')).filter(x => x.id != id);
                    localStorage.setItem('funcs', JSON.stringify(novo));
                    loadList();
                    alert('Excluído com sucesso');
                }
            });
        });
    }

    function route() {
        const hash = location.hash;
        if (!hash || hash === '#/' || hash === '') {
            loadList();
        } else {
            location.href = 'form.html' + hash;
        }
    }
    window.addEventListener('hashchange', route);
    window.addEventListener('load', route);
</script>
</body>
</html>
